
@using Entity_Layer
@model List<Categories>
@{
    Layout = null;
}



<html>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
        <script src="~/lib/jquery/dist/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.13.3/css/selectize.css" integrity="sha512-85w5tjZHguXpvARsBrIg9NWdNy5UBK16rAL8VWgnWXK2vMtcRKCBsHWSUbmMu0qHfXW2FVUDiWr6crA+IFdd1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.13.3/js/standalone/selectize.js" integrity="sha512-pF+DNRwavWMukUv/LyzDyDMn8U2uvqYQdJN0Zvilr6DDo/56xPDZdDoyPDYZRSL4aOKO/FGKXTpzDyQJ8je8Qw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script>
            var select_author;
            $(function () {
                 CreateAuthorSelectize();
                 LoadAuthorSelectize();
                 CreateCategorySelectize();
                 LoadCategorySelectize();
             });
            function CreateAuthorSelectize(){
                    select_author = $("#authorSelect").selectize({
                    create: false,
                    valueField: 'authorID',
                    sortField: 'authorID',
                    labelField: "authorName",
                    searchField: "authorName",
                    
                });
            }
            
            function LoadAuthorSelectize(){
                obj = {};
                $.ajax({
                    url: "/Books/getAuthors",
                    type: "GET",
                    data: obj
                }).done(function (data){
                    console.log(data);
                    for (var i =0;i<data.length;i++){
                        select_author[0].selectize.addOption(data[i]);
                    }
                    select_author[0].selectize.refreshOptions();
                });
            }

            function CreateCategorySelectize(){
                    select_category = $("#categorySelect").selectize({
                    create: false,
                    valueField: 'categoryID',
                    sortField: 'categoryID',
                    labelField: "categoryName",
                    searchField: "categoryName",
                    maxItems: 3,
                });
            }

            function LoadCategorySelectize(){
                obj = {};
                $.ajax({
                    url: "/Books/getCategories",
                    type: "GET",
                    data: obj
                }).done(function (data){
                    console.log(data);
                    for (var i =0;i<data.length;i++){
                        select_category[0].selectize.addOption(data[i]);
                    }
                    select_category[0].selectize.refreshOptions();
                });
            }
        </script>
    </head>
    <body>

        <form class="form-group">

            <input type="text" placeholder="Name" id="getName"/><br />
            <input type="number" placeholder="Pages" id="getPages"/><br />
            <input type="number" placeholder="Price" id="getPrice"/><br />
            <span>Author</span><br>
            <select id="authorSelect">
                
            </select><br />
            <span>Category</span><br>
            <select id="categorySelect"></select><br />
    
    
    

        </form>
            <button class="btn btn-primary" onclick="AddBook()">Add</button>
    </body>
</html>

<script>
    function AddBook(){
        obj={};
        obj.bookName = $("#getName").val();
        obj.bookPages = $("#getPages").val();
        obj.bookPrice = $("#getPrice").val();
        obj.authorID = $("#authorSelect").val();
        obj.categoryIDs = $("#categorySelect").val();
        $.ajax({
            url:"/Books/Create",
            type: "POST",
            data: obj
        }).done(function(data){
            alert("success");
        });
    }
</script>

















